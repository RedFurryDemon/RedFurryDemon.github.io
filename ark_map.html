<!DOCTYPE html>
<html>

<head>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="stylesheet" type="text/css" href="style/style__main.css">
<link rel="stylesheet" type="text/css" href="style/style_ark_map.css">

	<title>RFD's Scratchpad</title>
	<link rel="icon" type="image/svg+xml" href="assets/favicon.svg">

	<link id="theme_css" rel="stylesheet" type="text/css" href="style/theme_dark.css">

	<!--no defer!-->
	<script src="scripts/shared.js"></script>
<script src="scripts/ark_data_map.js"></script>
</head>

<body>

	<div id="header_id"></div>

	<div id="content_id">
		<h1>map of the Island</h1>
		<div class="textbg">
			<p>TO-DO:</p>
			<p>- validate all coordinate data for ARK Mobile accuracy</p>
			<p>- check if all underwater caves exist on ARK Mobile</p>
			<p>- show information about locations: name, coordinates, notes; for caves - artifact; for bases and outposts - owner; for ruins - explorer note/dossier name and id</p>
			<p>- show current coordinates on mouse-over</p>
			<p>- add more ruins and other points of interest</p>
			<p>- improve the map graphics</p>
		</div>
		<div id="mapInfo">
				<span id="mapInfoType">general</span>
				<h2 id="mapInfoName">no location selected</h2>
				<p>lat <span id="mapInfoLat"></span>, lon <span id="mapInfoLon"></span></p>
		</div>
<!--
<svg id="mapDot1" height="32" width="32">
  <defs>
    <radialGradient id="grad1" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
      <stop offset="15%" style="stop-color:rgb(0,240,255);stop-opacity:1" />
      <stop offset="70%" style="stop-color:rgb(0,240,255);stop-opacity:0.05" />
      <stop offset="90%" style="stop-color:rgb(0,240,255);stop-opacity:0" />
    </radialGradient>
  </defs>
  <circle cx="16" cy="16" r="12" fill="url(#grad1)" />
  Sorry, your browser does not support inline SVG.
</svg>-->

	<!--<img id="mapImageTopographic" width="1000" height="1000" src="assets/The_Island_Topographic_Map2.jpg"></img>
	<!--<img id="mapImageDrawn" width="1000" height="1000" src="assets/The_Island_Map.jpg"></img>
	<img id="mapImageFrame" width="1000" height="1000" src="assets/Clean_MAP_UI.png"></img>-->
<div id="mapCont">
		<div id="mapImageCont">
			<img id="mapImageSvg" width="1000" height="1000" src="assets/ARK_map.svg"></img>
		
			<svg id="mapMarkersSvg" xmlns="http://www.w3.org/2000/svg" width="1000" height="1000" viewBox="0 0 1000 1000">
				<defs>
					<radialGradient id="map_gradient_obelisk_green">
						<stop offset="20%" stop-color="hsla(120, 100%, 40%, 1)" />
						<stop offset="75%" stop-color="hsla(120, 100%, 40%, 0.05)" />
						<stop offset="96%" stop-color="hsla(120, 100%, 40%, 0)" />
					</radialGradient>
					<radialGradient id="map_gradient_obelisk_red">
						<stop offset="20%" stop-color="hsla(0, 100%, 50%, 1)" />
						<stop offset="75%" stop-color="hsla(0, 100%, 50%, 0.05)" />
						<stop offset="96%" stop-color="hsla(0, 100%, 50%, 0)" />
					</radialGradient>
					<radialGradient id="map_gradient_obelisk_blue">
						<stop offset="20%" stop-color="hsla(204, 100%, 50%, 1)" />
						<stop offset="75%" stop-color="hsla(204, 100%, 50%, 0.05)" />
						<stop offset="96%" stop-color="hsla(204, 100%, 50%, 0)" />
					</radialGradient>
					<radialGradient id="map_gradient_cave">
						<stop offset="15%" stop-color="hsla(90, 100%, 60%, 1)" />
						<stop offset="70%" stop-color="hsla(90, 100%, 60%, 0.05)" />
						<stop offset="90%" stop-color="hsla(90, 100%, 60%, 0)" />
					</radialGradient>
					<radialGradient id="map_gradient_cave_underwater">
						<stop offset="15%" stop-color="hsla(276, 100%, 50%, 1)" />
						<stop offset="70%" stop-color="hsla(276, 100%, 50%, 0.05)" />
						<stop offset="90%" stop-color="hsla(276, 100%, 50%, 0)" />
					</radialGradient>
					<radialGradient id="map_gradient_ruins">
						<stop offset="15%" stop-color="hsla(36, 100%, 50%, 1)" />
						<stop offset="70%" stop-color="hsla(36, 100%, 50%, 0.05)" />
						<stop offset="90%" stop-color="hsla(36, 100%, 50%, 0)" />
					</radialGradient>
					<radialGradient id="map_gradient_base">
						<stop offset="15%" stop-color="hsla(180, 100%, 50%, 1)" />
						<stop offset="70%" stop-color="hsla(180, 100%, 50%, 0.05)" />
						<stop offset="90%" stop-color="hsla(180, 100%, 50%, 0)" />
					</radialGradient>
					<radialGradient id="map_gradient_outpost">
						<stop offset="15%" stop-color="hsla(220, 100%, 70%, 1)" />
						<stop offset="70%" stop-color="hsla(220, 100%, 70%, 0.05)" />
						<stop offset="90%" stop-color="hsla(220, 100%, 70%, 0)" />
					</radialGradient>
				</defs>
		
				<!--
		  <use x="5" y="5" href="#myCircle" fill="url('#myGradient')" />
				<rect width="100%" height="100%" fill="#9005" />-->
			</svg>
		</div>
</div>


	<div id="arkmap_sidebar">
		<label for="coord_mult_field">coord multiplier:</label>
		<input id="coord_mult_field" type="number" inputmode="numeric" value="11.69" step="0.01" min="5" max="20" />
		<label for="dot_offset_x">offset x:</label>
		<input id="dot_offset_x" type="number" inputmode="numeric" value="-81" step="1" min="-500" max="500" />
		<label for="dot_offset_y">offset y:</label>
		<input id="dot_offset_y" type="number" inputmode="numeric" value="-81" step="1" min="-500" max="500" />

		<p id="arkmap_coords">coords: </p>
	</div>

	<!--
	https://ark.wiki.gg/images/0/04/The_Island_Topographic_Map.jpg
	1024 x 1024 px

	https://ark.wiki.gg/images/e/e2/The_Island_Map.jpg
	-->
	</div>

	<div id="footer_id"></div>

<script>

		const map_svg = document.getElementById("mapMarkersSvg");
		const svg_namespace = "http://www.w3.org/2000/svg";

		function drawDotsOld() {
			ctx.clearRect(0, 0, mapCanvas.width, mapCanvas.height);
			ctx.fillStyle = "black";
			//ctx.fillRect(0, 0, 32, 32); 
			//let radius = 24;
			let radius = 6;
			//converting map coordinates to canvas coordinates in pixels
			let coord_mult = Number(document.getElementById("coord_mult_field").value);
			let x_offset = Number(document.getElementById("dot_offset_x").value);
			let y_offset = Number(document.getElementById("dot_offset_y").value);

			console.log(typeof (radius));
			console.log(typeof (coord_mult));
			console.log(typeof (x_offset));
			console.log(typeof (y_offset));


			//let coord_mult = coord_mult_field").vaule;
			console.log(coord_mult);
			console.log(x_offset);
			console.log(y_offset);
			//let coord_mult = 10.24;
			//let coord_mult = 10;
			//let coord_mult = 11;

			for (let i = 0; i < location_list.length; i++) {
				let category = location_list[i].category[0];

				switch (category) {
					case "obelisk":
						ctx.fillStyle = "yellow";
						break;
					case "cave":
						ctx.fillStyle = "green";
						break;
					case "grotto":
						ctx.fillStyle = "blue";
						break;
					case "ruins":
						ctx.fillStyle = "red";
						break;
					case "base":
						ctx.fillStyle = "aqua";
						break;
					default:
						ctx.fillStyle = "white";
				}




				let x_min = (location_list[i].lon * coord_mult) - radius;
				//console.log(x_min);
				x_min = x_min + x_offset;
				x_min = x_min.toFixed(0);

				//console.log(x_min);
				//let x_max = location_list[i].lon + radius;
				let y_min = (location_list[i].lat * coord_mult) - radius;
				//console.log(y_min);
				y_min = y_min + y_offset;
				y_min = y_min.toFixed(0);
				//y_min = y_min + y_offset;
				//console.log(y_min);
				//let y_max = location_list[i].lat + radius;
				let circle = ctx.fillRect(x_min, y_min, radius, radius);
				circle.setAttribute("id", i);
			}
		}

function showMarkerData(i) {
	document.getElementById("mapInfoName").textContent = location_list[i].name;
	document.getElementById("mapInfoType").textContent = location_list[i].category[0];
	document.getElementById("mapInfoLat").textContent = location_list[i].lat;
	document.getElementById("mapInfoLon").textContent = location_list[i].lon;
}

		function drawDots() {
			//ctx.fillRect(0, 0, 32, 32); 
			//let radius = 24;
			let radius = 6;
			//converting map coordinates to canvas coordinates in pixels
			let coord_mult = Number(document.getElementById("coord_mult_field").value);
			let x_offset = Number(document.getElementById("dot_offset_x").value);
			let y_offset = Number(document.getElementById("dot_offset_y").value);

			/*
			console.log(typeof (radius));
			console.log(typeof (coord_mult));
			console.log(typeof (x_offset));
			console.log(typeof (y_offset));

			console.log(coord_mult);
			console.log(x_offset);
			console.log(y_offset);
			*/

			for (let i = 0; i < location_list.length; i++) {
				radius = 6;
				let marker = document.createElementNS(svg_namespace, "circle");

				let x = location_list[i].lon * coord_mult;
				x = x + x_offset;
				x = x.toFixed(0);

				let y = location_list[i].lat * coord_mult;
				y = y + y_offset;
				y = y.toFixed(0);

				let category = location_list[i].category[0];
				let color = "";

				switch (category) {
					case "obelisk_green":
						color = "url('#map_gradient_obelisk_green')";
						radius = radius * 2;
						break;
					case "obelisk_red":
						color = "url('#map_gradient_obelisk_red')";
						radius = radius * 2;
						break;
					case "obelisk_blue":
						color = "url('#map_gradient_obelisk_blue')";
						radius = radius * 2;
						break;
					case "cave":
						color = "url('#map_gradient_cave')";
						break;
					case "grotto":
						color = "url('#map_gradient_cave_underwater')";
						break;
					case "ruins":
						color = "url('#map_gradient_ruins')";
						break;
					case "outpost":
						color = "url('#map_gradient_outpost')";
						break;
					case "base":
						color = "url('#map_gradient_base')";
						radius = radius * 1.6;
						radius = radius.toFixed(0);
						break;
					default:
						color = "white";
				}

				marker.setAttribute("cx", x);
				marker.setAttribute("cy", y);
				marker.setAttribute("r", radius);
				marker.setAttribute("fill", color);
				marker.setAttribute("id", "marker" + i);

//marker.addEventListener("mouseover", (event) => {
//console.log(location_list[i].name);
//}, false);

marker.addEventListener("mouseover", function() {showMarkerData(i)}, false);



/*
marker.addEventListener("mouseover", (event) => {
let testText = event.target.id;
console.log(testText.slice(6));
let nope = Number(testText.slice(6));
console.log(location_list[nope].name);


}, false);
*/
				map_svg.appendChild(marker);
			}
		}

		drawDots();
		document.getElementById("coord_mult_field").addEventListener('change', drawDots);
		document.getElementById("dot_offset_x").addEventListener('change', drawDots);
		document.getElementById("dot_offset_y").addEventListener('change', drawDots);

/*
		function cnvs_getCoordinates(e) {
					x = e.clientX;
					y = e.clientY;
					document.getElementById("xycoordinates").innerHTML = "Coordinates: (" + x + "," + y + ")";
				}
		
				function cnvs_clearCoordinates() {
					document.getElementById("xycoordinates").innerHTML = "";
				}
		*/

	</script>

</body>

</html>